---
# Front-matter to make Jekyll process this file (render to CSS).
---



// Functions.
@use "utilities" as *;

// Basic reset, typography, links.
@use 'reset';
@use 'fonts';
@use 'typography';
@use 'links';



:root {
	@extend %font--calibre--regular;

	--logo--scale: 0.618; // Golden.

	--typography--leading:          1.2;
	--typography--leading--tagline: 1;

	--typography--size:          2rem;
	--typography--size--logo:    calc(var(--typography--size) * 4);
	--typography--size--tagline: calc(var(--typography--size) * 1.2);

	--margin:           calc(var(--typography--size) * 1.2);
	--margin--vertical: var(--margin);

	--page--width: 100vw;

	--column--ratio: 0.382fr 0.618fr; // Golden.

	--color--art:     #d22d2d;
	--color--media:   #e6a50f;
	--color--science: #145fb8;

	--color--transition: 200ms;

	--color--link:          rgba(0, 0, 0, 0.033);
	--color--link--reverse: rgba(255, 255, 255, 0.066);

	--link--enlargement:    0.4rem;
	--link--highlight:      var(--color--link--reverse);
	--link--outline:        0.2rem;

	scroll-behavior: smooth;

	@include breakpoint(320) { --typography--size: calc((20/375) * 100vw); } // Scale it all down from 20 @ 375.

	@include landscape {
		--logo--scale: 0.75;

		--typography--size--logo: calc(var(--typography--size) * 3.5);
	}

	@include breakpoint(768) {
		--logo--scale: 0.618; // Back to Golden.

		--typography--size:          clamp(2.4rem, (24/1440) * 100vw, 2.8rem);
		--typography--size--logo:    calc(var(--typography--size) * 5.5);
		--typography--size--tagline: calc(var(--typography--size) * 1.5);

		--margin: calc(var(--typography--size) * 2);

		--link--enlargement: 0.8rem;
	}

	// Cap width around a 16-inch MacBook Pro.
	@include breakpoint(1640) {
		--page--width: 164rem;
	}


	@include breakpoint(1772) { // Width cap, plus (now larger) margins.
		@include tall {
			--margin--vertical: calc(var(--margin) * 2);

			--typography--size--logo: calc(var(--typography--size) * 6.5);
		}
	}

	@include browser-specific(safari--mobile) {
		--color--link:          rgba(0, 0, 0, 0.1);
		--color--link--reverse: rgba(255, 255, 255, 0.2);
	}



	// From Viewporter JS.
	&.clockwise {
		--safe--inset--left:  0.4rem; // Optical shift.
		--safe--inset--right: calc(env(safe-area-inset-right) - 1.3rem); // Right to notch.
	}

	&.counter-clockwise {
		--safe--inset--left:  calc(env(safe-area-inset-left) - 1.3rem); // Right to notch.
		--safe--inset--right: 0.6rem; // Optical room for scroll indicator.
	}
}



body {
	// iPhone rotation and width cap.
	margin-left:   auto;
	margin-right:  auto;
	padding-left:  var(--safe--inset--left, 0rem);
	padding-right: var(--safe--inset--right, 0rem);
	width:         var(--page--width);

	@include landscape {
		padding-right: calc(var(--safe--inset--right, 0rem) + var(--tagline--height) + var(--margin));
	}



	// Scrolley stuff.
	--scroll--scale:           calc(1 - (1 - var(--logo--scale)) * var(--logo--scroll));
	--scroll--scale--duration: 100ms;

	--logo--height--scaled: calc(var(--logo--height) * var(--logo--scale, 1));

	--scroll--offset:        calc(var(--logo--height--scaled) + var(--tagline--height) + var(--margin) * 4);
	--scroll--offset--about: calc(var(--tagline--height) + var(--links--height) + var(--margin) * 4);

	@include landscape {
		--scroll--offset:        var(--margin--vertical);
		--scroll--offset--about: calc(var(--margin--vertical) - 0.1rem); // Hide overshoots.
	}

	@include breakpoint(768) { --scroll--scale--duration: 50ms; }// Can go faster on desktop.

	#art,
	#media,
	#science {
		scroll-margin-top: var(--scroll--offset);
	}

	#about {
		scroll-margin-top: var(--scroll--offset--about);
	}



	// Color transitions.
	--color:             white;
	--color--background: var(--color--accent);

	&.art { --color--accent: var(--color--art); }
	&.media { --color--accent: var(--color--media); }
	&.science { --color--accent: var(--color--science); }

	&.main {
		--color:             black;
		--color--background: white;

		--link--highlight: var(--color--link);

		&.art {
			[href="#art"] {     --color: var(--color--accent); }
			[href="#media"] {   --color: black; } // There are briefly multiple classes, so turn off the others.
			[href="#science"] { --color: black; }
		}

		&.media {
			[href="#art"] {     --color: black; }
			[href="#media"] {   --color: var(--color--accent); }
			[href="#science"] { --color: black; }
		}

		&.science {
			[href="#art"] {     --color: black; }
			[href="#media"] {   --color: black; }
			[href="#science"] { --color: var(--color--accent); }
		}
	}

	&,
	nav,
	aside {
		background:                 var(--color--background);
		transition-duration:        var(--color--transition);
		transition-property:        background;
		transition-timing-function: ease-in-out;
	}

	&.invert {
		&,
		nav,
		aside {
			transition-duration: 7800ms; // Ballparking the JS.
		}
	}

	&.main {
		&,
		nav,
		aside {
			transition-duration: var(--color--transition);
		}
	}

	@include landscape {
		nav,
		aside {
			background: initial;
		}
	}

	h1 > a,
	p,
	svg {
		color:                      var(--color);
		transition-delay:           calc(var(--color--transition) / 4);
		transition-duration:        calc(var(--color--transition) / 2);
		transition-property:        color, fill, stroke;
		transition-timing-function: linear;
	}



	// Main layout.
	> main,
	> footer {
		@include landscape {
			column-gap:            var(--margin);
			display:               grid;
			grid-template-columns: var(--column--ratio); // Golden.
			padding-left:          var(--margin);
			padding-right:         var(--margin);
		}
	}

	// The “Art, Science, Media” nav and nouns area.
	> main {
		position: sticky;
		top:      calc(-1 * var(--main--height) + var(--tagline--height) + var(--margin--vertical) * 2 - 0.1rem); // Hide overshoots.

		@import 'nav';
		@import 'venn';
		@import 'nouns';
	}

	// The “About” section, below.
	> footer {
		min-height: calc(100vh - var(--tagline--height) - var(--margin--vertical) * 2);

		@import 'aside';
		@import 'about';
	}
}
